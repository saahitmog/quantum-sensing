2022-10-06T10:37:38|ERROR|ESRMeasure|ESR_measurement Failed to update figure1: 'ESRMeasure' object has no attribute 'average_x'. ['Traceback (most recent call last):\n', '  File "C:\\Users\\ZHao\\.conda\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 273, in _on_display_update_timer\n    self.update_display()\n', '  File "C:\\Users\\Public\\quantum_sensing\\quantum_sensing\\fancy_microscope\\custommeasure2.py", line 294, in update_display\n    self.current_plotline.setData(self.average_x[:self.cutoff], self.average_y[:self.cutoff])\n', "AttributeError: 'ESRMeasure' object has no attribute 'average_x'\n"]
2022-10-06T10:37:38|ERROR|ESRMeasure|ESR_measurement Failed to update figure1: 'ESRMeasure' object has no attribute 'average_x'. ['Traceback (most recent call last):\n', '  File "C:\\Users\\ZHao\\.conda\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 273, in _on_display_update_timer\n    self.update_display()\n', '  File "C:\\Users\\Public\\quantum_sensing\\quantum_sensing\\fancy_microscope\\custommeasure2.py", line 294, in update_display\n    self.current_plotline.setData(self.average_x[:self.cutoff], self.average_y[:self.cutoff])\n', "AttributeError: 'ESRMeasure' object has no attribute 'average_x'\n"]
2022-10-06T10:37:38|ERROR|ESRMeasure|ESR_measurement Failed to update figure1: 'ESRMeasure' object has no attribute 'average_x'. ['Traceback (most recent call last):\n', '  File "C:\\Users\\ZHao\\.conda\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 273, in _on_display_update_timer\n    self.update_display()\n', '  File "C:\\Users\\Public\\quantum_sensing\\quantum_sensing\\fancy_microscope\\custommeasure2.py", line 294, in update_display\n    self.current_plotline.setData(self.average_x[:self.cutoff], self.average_y[:self.cutoff])\n', "AttributeError: 'ESRMeasure' object has no attribute 'average_x'\n"]
2022-10-06T10:37:46|CRITICAL|root|Unhandled exception:Traceback (most recent call last):
  File "C:\Users\Public\quantum_sensing\quantum_sensing\fancy_microscope\SRScontrol.py", line 52, in initSRS
    deviceID = SRS.query('*IDN?')
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\pyvisa\resources\messagebased.py", line 607, in query
    self.write(message)
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\pyvisa\resources\messagebased.py", line 228, in write
    count = self.write_raw(message.encode(enco))
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\pyvisa\resources\messagebased.py", line 202, in write_raw
    return self.visalib.write(self.session, message)
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\pyvisa\ctwrapper\functions.py", line 1866, in write
    ret = library.viWrite(session, data, len(data), byref(return_count))
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 193, in _return_handler
    raise errors.VisaIOError(ret_value)
pyvisa.errors.VisaIOError: VI_ERROR_RSRC_NFOUND (-1073807343): Insufficient location information or the requested device or resource is not present in the system.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Public\quantum_sensing\quantum_sensing\fancy_microscope\custommeasure2.py", line 160, in run
    my_SRS = SRSctl.initSRS(27, 'SG384')
  File "C:\Users\Public\quantum_sensing\quantum_sensing\fancy_microscope\SRScontrol.py", line 55, in initSRS
    sys.exit()
SystemExit

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\ScopeFoundry\measurement.py", line 25, in run
    self.measurement._thread_run()
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\ScopeFoundry\measurement.py", line 179, in _thread_run
    self.run()
  File "C:\Users\Public\quantum_sensing\quantum_sensing\fancy_microscope\custommeasure2.py", line 253, in run
    SRSctl.disableSRS_RFOutput(my_SRS)
UnboundLocalError: local variable 'my_SRS' referenced before assignment

2022-10-06T10:38:14|CRITICAL|root|Unhandled exception:Traceback (most recent call last):
  File "C:\Users\Public\quantum_sensing\quantum_sensing\fancy_microscope\DAQ_Analog.py", line 44, in configureDAQ
    channel = readTask.ai_channels.add_ai_voltage_chan(DAQ_APDInput,"",TerminalConfiguration.DIFFERENTIAL,minVoltage,maxVoltage,VoltageUnits.VOLTS)
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\nidaqmx\_task_modules\ai_channel_collection.py", line 2563, in add_ai_voltage_chan
    check_for_error(error_code)
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\nidaqmx\errors.py", line 127, in check_for_error
    raise DaqError(error_buffer.value.decode("utf-8"), error_code)
nidaqmx.errors.DaqError: Device cannot be accessed.  Possible causes:
Device is no longer present in the system.
Device is not powered.
Device is powered, but was temporarily without power.
Device and/or chassis driver support may have been removed.
Device is damaged.
Ensure the device is properly connected and turned on. Ensure the device and/or chassis is supported in the current version of the driver. Check the device's status in NI MAX. Turn the computer off and on again. If you suspect that the device is damaged, contact National Instruments at ni.com/support.
Device Specified: Dev1

Task Name: _unnamedTask<0>

Status Code: -201003

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Public\quantum_sensing\quantum_sensing\fancy_microscope\custommeasure2.py", line 178, in run
    task = DAQ.configureDAQ(self.settings.N_samples.value)
  File "C:\Users\Public\quantum_sensing\quantum_sensing\fancy_microscope\DAQ_Analog.py", line 64, in configureDAQ
    sys.exit()
SystemExit

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\ScopeFoundry\measurement.py", line 25, in run
    self.measurement._thread_run()
  File "C:\Users\ZHao\.conda\envs\scopefoundry\lib\site-packages\ScopeFoundry\measurement.py", line 179, in _thread_run
    self.run()
  File "C:\Users\Public\quantum_sensing\quantum_sensing\fancy_microscope\custommeasure2.py", line 248, in run
    rc = admin.CloseInstrument(instId)
UnboundLocalError: local variable 'instId' referenced before assignment

